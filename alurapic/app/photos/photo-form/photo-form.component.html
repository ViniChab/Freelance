<div id="master" *ngIf="!token else redirect()">
  <div class="container">
    <form [formGroup]="photoForm" class="row" (submit)="upload()" >
      <div class="col-md-6 text-center" >

          <div class="form-group" *ngIf="!preview; else previewImage">
              <button id='button_image' type="button" (click)="fileInput.click()" class="btn btn-primary">
                    <i id="But" class="fa fa-image"></i>
              </button>      
              <input 
                #fileInput
                hidden
                formControlName="file" 
                type="file" 
                accept="image/*"
                (change)="handleFile($event.target.files[0])"
              >
              <ap-vmessage
                text="Please, select a photo" 
                *ngIf="photoForm.get('file').errors?.required"
              >
              </ap-vmessage>
            </div>

              <ng-template #previewImage>
                  <ap-photo [url]="preview" title="Preview">
                  </ap-photo>
              </ng-template>

      </div>

      <div id="all">
    
        <div>
          <div class="form-group">
            <textarea #input
              formControlName="description" 
              class="form-control form-control-sm" 
              placeholder="Photo description..."></textarea>
          </div>

          <small>*The maximum amount of characters is 400</small>
          
          <ap-vmessage 
          *ngIf="photoForm.get('description').errors?.maxlength"
          text="MAXIMUM LENGTH IS 400 CHARACTERS">
          </ap-vmessage>

          <ap-vmessage 
          *ngIf="photoForm.get('description').errors?.required"
          text="Description is required!">
          </ap-vmessage>
      
          <div class="form-group">
            <label class="text-muted">
              Allow comments
              <input formControlName="allowComments" type="checkbox">
              <!--html puro pra colocar checkbox-->
            </label>
          </div>

          <div *ngIf='!percent; else upload1' >
          
            <button [disabled]="photoForm.invalid || photoForm.pending" id="submit" type="submit"
              class="btn btn-primary btn-block">
              Upload
            </button>

          <br>
          </div>

          <button id='cancel' button onclick="location.href = '/home'"> 
          Back home
          </button>
            <ng-template #upload1>
              <div class="text-center">
                Upload progress: {{percent}}%
              </div>
            </ng-template>

        </div>
      </div>
    </form>
  </div>
</div>